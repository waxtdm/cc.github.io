<!doctype html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="Access-Control-Allow-Origin" content="*" />
    <!-- <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"> -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="/images/icon/favicon.ico" />
    <link rel="apple-touch-icon" href="/images/logo/apple-touch-icon.png" />
    <link rel="bookmark" href="/images/logo/apple-touch-icon.png" />
    <link rel="apple-touch-icon-precomposed" sizes="200x200" href="/images/logo/apple-touch-icon.png" />
    <!-- 控制缓存 -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="description" content="一个默默无闻的主页" />
    <meta name="keywords" content="小鱼,个人主页" />
    <meta name="author" content="小鱼" />
    <meta name="theme-color" content="#424242" />
    <title>小鱼の主页</title>
    <!-- HarmonyOS Sans -->
    <!-- 本站 CDN 已开启防盗链，非本站域名不可访问，请更改链接为下方内容，否则自定义字体将失效 -->
    <link rel="stylesheet" href="https://s1.hdslb.com/bfs/static/jinkela/long/font/regular.css" />
    <!-- <link rel="stylesheet" href="https://cdn.imsyy.top/gh/imsyy/file/font/HarmonyOS_Sans/regular.min.css" /> -->
    <!-- IE Out -->
    <script>
        if (/*@cc_on!@*/ false || (!!window.MSInputMethodContext && !!document.documentMode))
          window.location.href =
            'https://support.dmeng.net/upgrade-your-browser.html?referrer=' +
            encodeURIComponent(window.location.href);
    </script>
    <script type="module" crossorigin src="/assets/index-8563787c.js"></script>
    <link rel="stylesheet" href="/assets/index-f357e52c.css">
    <link rel="manifest" href="/manifest.webmanifest">
    <script id="vite-plugin-pwa:register-sw" src="/registerSW.js"></script>
</head>

<body>
    <!-- 主体内容 -->
    <div id="app"></div>
    <!-- noscript -->
    <noscript>
        <div style="text-align: center">请开启 JavaScript</div>
    </noscript>

    <script>
        // 检查查询参数或Cookie来决定是否强制刷新
        if (window.location.search.includes('refresh') || document.cookie.includes('forceRefresh=true')) {
          window.location.reload(true); // 强制刷新页面
        }
    </script>


    <select id="songSelect">
        <!-- 歌曲选项将通过JavaScript动态生成 -->
    </select>
    <button id="stopButton">停止播放</button>
    <script>
        let audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        let currentSource = null;
        let currentSongIndex = -1;
        
        // 定义音乐文件的链接
        const songs = [
        'https://download.kstore.space/download/4645/Tvbox/myks/audio/C42.mp3',
          'https://download.kstore.space/download/4645/Tvbox/myks/audio/C41.mp3',
          'https://download.kstore.space/download/4645/Tvbox/myks/audio/C40.mp3',
          'https://download.kstore.space/download/4645/Tvbox/myks/audio/九十九朵泪花.mp3',
          'https://download.kstore.space/download/4645/Tvbox/myks/audio/云山.mp3',
          'https://download.kstore.space/download/4645/Tvbox/myks/audio/你总要学会往前走.mp3',
          'https://download.kstore.space/download/4645/Tvbox/myks/audio/后来遇到的人.mp3',
          'https://download.kstore.space/download/4645/Tvbox/myks/audio/大风吹倒梧桐树.mp3',
          'https://download.kstore.space/download/4645/Tvbox/myks/audio/就算悲伤结局.mp3',
          'https://download.kstore.space/download/4645/Tvbox/myks/audio/待我.mp3',
          'https://download.kstore.space/download/4645/Tvbox/myks/audio/很任性.mp3',
          'https://download.kstore.space/download/4645/Tvbox/myks/audio/我真的会哭.mp3',
          'https://download.kstore.space/download/4645/Tvbox/myks/audio/离别开出花.mp3',
          'https://download.kstore.space/download/4645/Tvbox/myks/audio/落地生花.mp3',
          'https://download.kstore.space/download/4645/Tvbox/myks/audio/车窗外飘着雪.mp3'
        ];
        
        function loadAndPlayMusic(url) {
        let xhr = new XMLHttpRequest();
        xhr.open('GET', url, true);
        xhr.responseType = 'arraybuffer';
        
        xhr.onload = function() {
            audioCtx.decodeAudioData(xhr.response, function(buffer) {
                playSound(buffer);
            }, function(error) {
                console.error('解码失败:', error);
            });
        };
        
        xhr.send();
        }
        
        function playSound(buffer) {
        if (currentSource) {
            currentSource.stop();
        }
        
        currentSource = audioCtx.createBufferSource();
        currentSource.buffer = buffer;
        currentSource.connect(audioCtx.destination);
        currentSource.start();
        
        // 监听音频结束事件
        currentSource.onended = playNextSong;
        }
        
        function playNextSong() {
        currentSongIndex = (currentSongIndex + 1) % songs.length;
        let nextSongUrl = songs[currentSongIndex];
        loadAndPlayMusic(nextSongUrl);
        }
        
        function stopSound() {
        if (currentSource) {
            currentSource.stop();
            currentSource = null;
        }
        }
        
        // 页面加载完成后随机播放一首歌曲
        window.onload = function() {
        if (songs.length > 0) {
            currentSongIndex = Math.floor(Math.random() * songs.length);
            let randomSongUrl = songs[currentSongIndex];
            loadAndPlayMusic(randomSongUrl);
        } else {
            console.error('没有可用的歌曲');
        }
        
        // 添加停止播放按钮的点击事件
        document.getElementById('stopButton').addEventListener('click', stopSound);
        };
    </script>
    <!-- <script>
        let audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        let xhr = new XMLHttpRequest();
        xhr.open("GET", "https://ckflv.icu/api/rand.music?sort=热歌榜");
        xhr.responseType = "arraybuffer";
        xhr.addEventListener("load", () => {
        let playsound = (audioBuffer) => {
            let source = audioCtx.createBufferSource();
            source.buffer = audioBuffer;
            source.connect(audioCtx.destination);
            source.loop = true;
            source.start();
        };
        audioCtx.decodeAudioData(xhr.response, function(data) {
        playsound(data);
        });
        });
        xhr.send();
    </script>-->

    <!--随机播放音乐-->
    <!--   
<script Language="JavaScript">
　　myok=new Array(15);
　　myok[0]="https://download.kstore.space/download/4645/Tvbox/myks/audio/车窗外飘着雪.mp3'";
　　myok[1]="https://download.kstore.space/download/4645/Tvbox/myks/audio/落地生花.mp3'";
　　myok[2]="https://download.kstore.space/download/4645/Tvbox/myks/audio/离别开出花.mp3'";
　　myok[3]="https://download.kstore.space/download/4645/Tvbox/myks/audio/我真的会哭.mp3'";
　　myok[4]="https://download.kstore.space/download/4645/Tvbox/myks/audio/很任性.mp3'";
　　myok[5]="https://download.kstore.space/download/4645/Tvbox/myks/audio/待我.mp3'";
　　myok[6]="https://download.kstore.space/download/4645/Tvbox/myks/audio/就算悲伤结局.mp3'";
　　myok[7]="https://download.kstore.space/download/4645/Tvbox/myks/audio/大风吹倒梧桐树.mp3'";
　　myok[8]="https://download.kstore.space/download/4645/Tvbox/myks/audio/后来遇到的人.mp3'";
　　myok[9]="https://download.kstore.space/download/4645/Tvbox/myks/audio/你总要学会往前走.mp3'";
　　myok[10]="https://download.kstore.space/download/4645/Tvbox/myks/audio/云山.mp3'";
　　myok[11]="https://download.kstore.space/download/4645/Tvbox/myks/audio/九十九朵泪花.mp3'";
　　myok[12]="https://download.kstore.space/download/4645/Tvbox/myks/audio/C40.mp3'";
　　myok[13]="https://download.kstore.space/download/4645/Tvbox/myks/audio/C41.mp3'";
　　myok[14]="https://download.kstore.space/download/4645/Tvbox/myks/audio/C42.mp3'";
　　index = Math.floor(Math.random() * myok.length);
　　document.write("<EMBED id=M src='"+myok[index]+" width=0 height=0 autostart=true loop=true type=audio/mpeg>");
</Script>
-->
    <!--在线播放器API
<script src="https://myhkw.cn/api/player/170450247055" id="myhk" key="170450247055" m="1"></script>-->

    <!--雪花API
<script src='https://api.vvhan.com/api/snow'></script>
-->

    <!--看板娘
<script src="https://fastly.jsdelivr.net/gh/huangwb8/live2d_bensz@latest/front/autoload.js"></script>
<script src="https://myhkw.cn/player/js/jquery.min.js" type="text/javascript"></script>-->
</body>

</html>